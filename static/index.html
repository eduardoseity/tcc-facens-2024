<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <title>Teste</title>
    <script>
      var root = 'https://tcc-facens-2023.onrender.com'
    </script>
  </head>
  <body>
    <form id="predictForm">
      Modelo<br>
      <select name="model" id="model">
      </select><br><br>
      <script>
        modelSelect = document.getElementById('model');
        modelArray = fetch(root+'/models').then((res) => {
          res.json().then((data) => {
            data['models'].map( (model, i) => {
              let opt = document.createElement("option");
                opt.value = model;
                opt.innerHTML = model;
                modelSelect.append(opt);
            });
          });
        });
      </script>
      Área total (m²)<br>
      <input type="range" name="totalAreas" id="totalAreas" min="70" max="1000" step="1" value="70" oninput="this.nextElementSibling.value = this.value"><output>70</output><br>
      Área útil (m²)<br>
      <input type="range" name="usableAreas" id="usableAreas" min="70" max="1000" step="1" value="70" oninput="this.nextElementSibling.value = this.value"><output>70</output><br>
      Vagas<br>
      <input type="range" name="parkingSpaces" id="parkingSpaces" min="1" max="5" value="1" oninput="this.nextElementSibling.value = this.value"><output>1</output><br>
      Banheiros<br>
      <input type="range" name="bathrooms" id="bathrooms" min="1" max="5" value="1" oninput="this.nextElementSibling.value = this.value"><output>1</output><br>
      Suítes<br>
      <input type="range" name="suites" id="suites" min="0" max="5" value="0" oninput="this.nextElementSibling.value = this.value"><output>1</output><br>
      Quartos<br>
      <input type="range" name="bedrooms" id="bedrooms" min="1" max="5" value="1" oninput="this.nextElementSibling.value = this.value"><output>1</output><br><br>
      Bairro<br>
      <select name="neighborhood" id="neighborhood"></select><br><br>
      <script>
        neighborhoodSelect = document.getElementById('neighborhood');
        neighborhoodArray = fetch(root+'/neighborhoods').then((res) => {
          res.json().then((data) => {
            data['neighborhoods'].map( (neighborhood, i) => {
              let opt = document.createElement("option");
                opt.value = neighborhood;
                opt.innerHTML = neighborhood;
                neighborhoodSelect.append(opt);
            });
          });
        });
      </script>
      <input type="checkbox" name="condominium" id="condominium" value="1"> Condomínio<br>
      <input type="hidden" name="condominium" id="condominium" value="0">
      <input type="checkbox" name="AIR_CONDITIONING" id="AIR_CONDITIONING" value="1"> Ar-condicionado<br>
      <input type="hidden" name="AIR_CONDITIONING" id="AIR_CONDITIONING" value="0">
      <input type="checkbox" name="POOL" id="POOL" value="1"> Piscina<br>
      <input type="hidden" name="POOL" id="POOL" value="0">
      <input type="checkbox" name="BARBECUE_GRILL" id="BARBECUE_GRILL" value="1"> Churrasqueira<br>
      <input type="hidden" name="BARBECUE_GRILL" id="BARBECUE_GRILL" value="0"><br>
      <input type="submit" value="Enviar">
    </form><br>
    <span id="price">
    </span>
    <script>
      $('#predictForm').submit(function(e) {
        e.preventDefault();
        document.getElementById('price').innerHTML = "Aguarde...";
        let model = document.getElementById('model').value;
        let data = {};
        $(this).serializeArray().forEach((item) => {
          data[item["name"]] = item["value"];
        });
        let body = {
          "model":model,
          "data":data
        };
        console.log(data);
        $.ajax({
          type: 'POST',
          url: root+'/predict',
          data: JSON.stringify(body),
          contentType: 'application/json',
          dataType: 'text',
          success: (data) => {
            document.getElementById('price').innerHTML = data;
          },
          error: (err) => {
            console.log(err);
          }
        });
      });
    </script>
  </body>
</html>
